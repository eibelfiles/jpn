//! Japanisu v9.2
var t,e;t=this,e=function(){function t({dataset:t}){const e={};return Object.keys(t).forEach((n=>{var s;e[n]="true"===(s=t[n])||"false"!==s&&(+s+""===s?+s:"null"===s||""===s?null:s)})),e}function e(t,e){let n=0;if("object"==typeof(s=t)&&"number"==typeof s.length){const s=t.length;for(;n<s&&!1!==e.call(t[n],t[n],n);n++);}else for(n in t)if(!1===e.call(t[n],t[n],n))break;var s;return t}function n(t){return function(n,s){n.length||(n=[n]),e(n,(function(e){e.classList[t](s)}))}}function s(t,e){return t.classList.contains(e)}const i=n("add"),o=n("remove"),a=n("toggle"),r="is-active",c={outside:!1},l="is-active",d={class:"is-active"},u="--ws-offset-scroll",g="is-active",m="modal-is-open",h="is-active",v={Tab:function(t){let n;e(t.querySelectorAll("[data-target]"),(t=>{const e=document.getElementById(t.dataset.target);s(t,r)&&(n=[t,e],i(e,r)),function(t,e,n){t.addEventListener("click",n)}(t,0,(()=>{const s=[t,e];n&&o(n,r),n=s,i(n,r)}))}))},Accordion:class{constructor(e){this.element=e,this.active=!1;const n=e.querySelectorAll("[data-toggle]");this.config={...c,...t(e)},n&&(this.titles=n,this.init())}init(){e(this.titles,(t=>{const e=t.parentNode,n=e.parentNode.querySelectorAll("[data-item]");t.addEventListener("click",(t=>{const a=this.config.outside?e=>{t===e||this.element.contains(e.target)||n.length&&(o(n,l),this.active=!1)}:()=>{};this.active||(document.addEventListener("click",a),this.active=!0),s(e,l)?o(e,l):(n.length&&o(n,l),i(e,l))}))}))}},Outside:class{constructor(e){this.element=e;const n=t(e);this.config={...d,...n},this.target=n.target?document.getElementById(n.target):this.element,this.init()}init(){this.element.addEventListener("click",this.handleClick.bind(this))}handleClick(t){const e=this.element,n=this.target,a=this.config.class;s(n,a)?o([e,n],a):(i([e,n],a),document.addEventListener("click",(function s(i){i===t||i.target===n||n.contains(i.target)||(o([e,n],a),document.removeEventListener("click",s))})))}},Watch:function(e){!function(t,e){new window.IntersectionObserver((function(t){t.forEach((t=>{t.isIntersecting&&t.target.classList.add(e)}))}),{threshold:1}).observe(t)}(e,{class:"is-visible",...t(e)}.class)},Modal:class{constructor(t){const e=t.getAttribute("data-target");e&&(this.target=document.querySelector(e),this.dialog=this.target.querySelector("[data-dialog]"),this.element=t,this.close=document.querySelectorAll("[data-close]"),this.init())}init(){this.element.addEventListener("click",this.show.bind(this)),this.target.addEventListener("click",(t=>{this.dialog.contains(t.target)||this.hide()})),e(this.close,(t=>{t.addEventListener("click",this.hide.bind(this))}))}hide(){const t=function(t){if(!t)return 0;const e=window.getComputedStyle(t),n=e.transitionDuration,s=e.transitionDelay;return parseFloat(n)||parseFloat(s)?1e3*(parseFloat(s.split(",")[0])+parseFloat(n.split(",")[0])):0}(this.target)+5;this.escape&&(this.escape(),this.escape=null),this.target.classList.remove(g),setTimeout((()=>{document.body.classList.remove(m),document.body.style.removeProperty(u),document.body.style.paddingRight="",document.body.style.overflow=""}),t)}show(){const t=function(){const t=document.createElement("div");t.classList.add("modal-scrollbar-measure"),document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e}()+"px";var e,n,s;document.body.classList.add(m),document.body.style.setProperty(u,t),document.body.style.paddingRight=t,document.body.style.overflow="hidden",this.target.classList.add(g),this.escape=(e=window,n="keydown",s=t=>{"Escape"===t.key&&this.hide()},void e.addEventListener(n,(function t(i){s(i),e.removeEventListener(n,t)})))}},Group:class{constructor(t){const e=t.getAttribute("data-target"),n=document.querySelectorAll(e);this.prev=null,n&&(this.targets=n,this.elements=t.querySelectorAll("[data-class]"),this.init())}init(){e(this.elements,(t=>{const e=t.getAttribute("data-class");t.addEventListener("click",(t=>{this.handleClick(t,e)}))}))}handleClick(t,e){t.preventDefault();const n=this.targets,s=t.target,a=this.prev;a&&(o(n,a.previous),o(a.el,"is-active")),i(n,e),i(s,"is-active"),this.prev={previous:e,el:s}}},Dropdown:function(t){t.addEventListener("click",(e=>{const n=t.parentNode;s(n,h)?o([t,n],h):(i([t,n],h),document.addEventListener("click",(function s(i){i===e||i.target===n||n.contains(i.target)||(o([t,n],h),document.removeEventListener("click",s))})))}))}};return e({add:i,remove:o,toggle:a},((t,e)=>{v[e]=function(e){const n=e.getAttribute("data-target"),s=e.getAttribute("data-class")||"is-active",i=n?document.querySelectorAll(n):[e];i&&s&&e.addEventListener("click",(()=>{t(i,s)}))}})),e(v,((t,n)=>{const s=n.toLowerCase();e(document.querySelectorAll(`[data-wjs="${s}"]`),(e=>{new t(e)}))})),v},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).whale=e(),function(){function t(t){return document.getElementById(t)}function e(t,e){return(e||document).querySelector(t)}function n(t){var e=t.split(":");return 60*+e[0]*60+60*+e[1]}const s={day:86400,hour:3600,minute:60,second:1},i=t=>{const e=new Intl.RelativeTimeFormat,n=(t=>(Date.now()-t)/1e3)(t),{value:i,unit:o}=(t=>{for(const[e,n]of Object.entries(s))if(t>=n||"second"===e)return{value:-1*Math.floor(t/n),unit:e}})(n);return e.format(i,o)};function o(t="America/Hermosillo"){let e=new Date,n=e.toLocaleTimeString([],{timeStyle:"short",timeZone:t}),s=e.toLocaleString("es",{weekday:"long",timeZone:t});return{date:e,time:n,week:s}}function a(t,e){let n="";for(const s of t.slice(0,e)){let t=s.played_at,e=new Date(1e3*t);n+=`\n        <div class="history-item" style="--his-bg: url(${s.song.art})">\n          <div class="history-meta">\n            <h3 class="history-title">${s.song.title}</h3>\n            <div class="history-artist">${s.song.artist}</div>\n            <span class="history-timeago">${i(e)}</span>\n          </div>\n        </div>\n      `}return n}function r(t,n){let s=e(".song-cover",t),i=e(".song-title",t),o=e(".song-artist",t),a=e(".song-album",t);s&&(s.src=n.art),i&&(i.innerText=n.title),o&&(o.innerText=n.artist),a&&(a.innerText=n.album)}const c=e(".player"),l=e(".player-audio");if(l&&l.dataset.src){const C=new Audio(l.dataset.src),$=e(".player-volume",l);$.addEventListener("change",(function(t){C.volume=t.currentTarget.value/100,localStorage.setItem("player_vol",C.volume)}),!1);var d=localStorage.getItem("player_vol");d&&(C.volume=d,$.value=100*d);var u=e(".player-toggle",l);"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("play",(function(){m()})),navigator.mediaSession.setActionHandler("pause",(function(){h()})));var g=null;function m(){C.load(),c.classList.toggle("is-playing"),C.play(),u.innerHTML='<svg class="i i-pause" viewBox="0 0 24 24"><path d="M5 4h4v16H5Zm10 0h4v16h-4Z"></path></svg>',null==g&&function(t){t.crossOrigin="anonymous";const e=new AudioContext,n=e.createMediaElementSource(t),s=e.createAnalyser();n.connect(s),n.connect(e.destination);const i=new Uint8Array(s.frequencyBinCount);s.getByteFrequencyData(i);const o=document.querySelector(".visualizer");for(let t=0;t<20;t++){const e=document.createElement("DIV");e.setAttribute("id","bar"+t),e.setAttribute("class","visualizer-item"),o.appendChild(e)}!function t(){s.getByteFrequencyData(i);for(let t=0;t<20;t++){const e=i[2*(t+10)],n=document.querySelector("#bar"+t);if(!n)continue;const s=Math.max(4,e||0);n.style.height=s+"px"}window.requestAnimationFrame(t)}()}(C),g="init visualizer"}function h(){c.classList.toggle("is-playing"),C.pause(),u.innerHTML='<svg class="i i-play" viewBox="0 0 24 24"><path d="m7 3 14 9-14 9z"></path></svg>'}u.addEventListener("click",(()=>{C.paused?m():h()}),!1)}const v="https://stream.radioani.me/api/nowplaying_static/japanisu.json",y=t("playerHistory");!function t(){fetch(v).then((t=>t.json())).then((n=>{let s=n.song_history,i=e(".song-now",c),o=e(".song-next",c),l=n.now_playing.remaining,d=e(".posterA"),u=e(".posterB");d&&d.src&&(d.crossOrigin="Anonymous",d.src="https://images.weserv.nl/?url="+encodeURIComponent(n.now_playing.song.art),function(t,e){let n=new ColorThief;e.complete?t.setAttribute("style",`--accent: rgb(${n.getColor(e)})`):e.addEventListener("load",(function(){t.setAttribute("style",`--accent: rgb(${n.getColor(e)})`)}))}(document.body,d)),u&&u.src&&(u.crossOrigin="Anonymous",u.src="https://images.weserv.nl/?url="+encodeURIComponent(n.playing_next.song.art)),i&&r(i,n.now_playing.song),o&&r(o,n.playing_next.song);var g=k.classList.contains("is-active")?15:4;y&&(k.onclick=()=>{k.classList.remove("is-active"),E.classList.remove("has-history"),y.innerHTML=a(s,4),b.innerText="Ver más"},b.onclick=()=>{k.classList.contains("is-active")?(k.classList.remove("is-active"),E.classList.remove("has-history"),y.innerHTML=a(s,4),b.innerText="Ver más"):(k.classList.add("is-active"),E.classList.add("has-history"),y.innerHTML=a(s,15),b.innerText="Ver menos")},y.innerHTML=a(s,g)),"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:n.now_playing.song.title,artist:n.now_playing.song.artist,album:n.now_playing.song.album,artwork:[{src:n.now_playing.song.art,sizes:"96x96",type:"image/png"},{src:n.now_playing.song.art,sizes:"128x128",type:"image/png"},{src:n.now_playing.song.art,sizes:"192x192",type:"image/png"},{src:n.now_playing.song.art,sizes:"256x256",type:"image/png"}]})),document.querySelectorAll(".player-meta").forEach((t=>{var n=e(".song-title",t),s=n.offsetWidth,i=t.offsetWidth;t.setAttribute("style","--title-width:"+i+"px"),s>i?n.classList.add("song-very-long"):n.classList.remove("song-very-long")})),setTimeout(t,1e3*l)})).catch((t=>console.log(t)))}();const p=t("listeners");function f(t){return`\n      <div class="upcoming bg-dark shadow-xl" data-start="${t.start}" data-end="${t.end}" data-weekday="${t.day}" >\n        <img class="upcoming-image fit-image" src="${t.poster}" alt="${t.title}">\n        <div class="upcoming-data fs-7 relative py-.75 px-1.25">\n          <div class="upcoming-title fw-500 color-title nowrap">${t.title}</div>\n          <div class="upcoming-snippet fw-500 my-1">${t.snippet}</div>\n          <div class="upcoming-time">${t.start} - ${t.end}</div>\n        </div>\n      </div>\n    `}p&&function t(){fetch(v).then((t=>t.json())).then((e=>{let n=e.listeners.current;p.innerText=n,setTimeout(t,1e3*(p.dataset.update||5))})).catch((t=>console.log(t)))}();const w=t("program"),L=t("showWeeklySchedule"),b=t("showRecentlyPlayed"),k=t("closeHistory"),E=t("blog");function A(){let t=o(),e=w.querySelectorAll(".program-program"),s=n(t.time);e.forEach((e=>{if(e.dataset.week==t.week){e.querySelectorAll(".upcoming").forEach((t=>{let e=n(t.dataset.start),i=n(t.dataset.end);e<=s&&i>s?t.classList.add("is-online"):t.classList.remove("is-online")}))}}))}function S(){w.classList.add("program","grid","l:cols-7","cols-1","is-active"),w.querySelectorAll(".program-program").forEach((t=>{let e=t.dataset.week;var n,s,i;t.innerHTML=(n=currentSchedule,s=e,i="",n.forEach((t=>{t.day==s&&(i+=f(t))})),i)})),w.classList.remove("none")}w&&L.addEventListener("click",(()=>{L.classList.contains("is-active")?(L.classList.remove("is-active"),w.classList.add("none"),w.classList.remove("program","grid","l:cols-7","cols-1","is-active"),w.querySelectorAll(".program-program").forEach((t=>{t.innerHTML=""})),clearInterval(A)):(L.classList.add("is-active"),S(),A(),setInterval(A,1e4))}),!1);const x=t("renderUpcoming");function T(){let t=o();x.querySelectorAll(".upcoming").forEach((e=>{let s=(n(e.dataset.start)-n(t.time))/16+48,i=(n(e.dataset.start)-(n(t.time)-86400))/16+48;e.setAttribute("style",`transform: translateX(${e.dataset.weekday==t.week?s:i}px)`),e.classList.add("is-loaded")}))}x&&(T(),setInterval(T,2e4)),function t(){let e=o(),s=n("24:00")-n(e.time);x&&(x.innerHTML=function(t){let e=o();var n="";let s=(i=e.week,a="","lunes"==i?a="martes":"martes"==i?a="miércoles":"miércoles"==i?a="jueves":"jueves"==i?a="viernes":"viernes"==i?a="sábado":"sábado"==i?a="domingo":"domingo"==i&&(a="lunes"),a);var i,a;return t.forEach((t=>{t.day!=e.week&&t.day!=s||(n+=f(t))})),n}(currentSchedule)),T(),setTimeout(t,1e3*(0===s?10:s))}();const q=document.querySelector(".header-player");window.innerWidth>760&&function(){if(q){var t=q.offsetHeight;window.addEventListener("scroll",(function(){window.scrollY>q.offsetTop+t?(q.nextElementSibling.setAttribute("style","margin-top:"+t+"px"),q.classList.add("header-sticky","fixed","z-100","t-0","x-0")):(q.classList.remove("header-sticky","fixed","z-100","t-0","x-0"),q.nextElementSibling.removeAttribute("style"))}))}}(),e("[data-flickity]")&&Defer.js("https://cdn.jsdelivr.net/npm/flickity@2/dist/flickity.pkgd.min.js","flickity",100,null,!0),Defer.dom(".lazyload",0,"is-loaded"),document.body.classList.remove("preload")}();