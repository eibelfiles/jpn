//! Japanisu v10.0.0
var e,t;e=this,t=function(){function e({dataset:e}){const t={};return Object.keys(e).forEach((n=>{var s;t[n]="true"===(s=e[n])||"false"!==s&&(+s+""===s?+s:"null"===s||""===s?null:s)})),t}function t(e,t){let n=0;if("object"==typeof(s=e)&&"number"==typeof s.length){const s=e.length;for(;n<s&&!1!==t.call(e[n],e[n],n);n++);}else for(n in e)if(!1===t.call(e[n],e[n],n))break;var s;return e}function n(e){return function(n,s){n.length||(n=[n]),t(n,(function(t){t.classList[e](s)}))}}function s(e,t){return e.classList.contains(t)}const i=n("add"),o=n("remove"),a=n("toggle"),r="is-active",c={outside:!1},l="is-active",d={class:"is-active"},u="--ws-offset-scroll",m="is-active",g="modal-is-open",y="is-active",h={Tab:function(e){let n;t(e.querySelectorAll("[data-target]"),(e=>{const t=document.getElementById(e.dataset.target);s(e,r)&&(n=[e,t],i(t,r)),function(e,t,n){e.addEventListener("click",n)}(e,0,(()=>{const s=[e,t];n&&o(n,r),n=s,i(n,r)}))}))},Accordion:class{constructor(t){this.element=t,this.active=!1;const n=t.querySelectorAll("[data-toggle]");this.config={...c,...e(t)},n&&(this.titles=n,this.init())}init(){t(this.titles,(e=>{const t=e.parentNode,n=t.parentNode.querySelectorAll("[data-item]");e.addEventListener("click",(e=>{const a=this.config.outside?t=>{e===t||this.element.contains(t.target)||n.length&&(o(n,l),this.active=!1)}:()=>{};this.active||(document.addEventListener("click",a),this.active=!0),s(t,l)?o(t,l):(n.length&&o(n,l),i(t,l))}))}))}},Outside:class{constructor(t){this.element=t;const n=e(t);this.config={...d,...n},this.target=n.target?document.getElementById(n.target):this.element,this.init()}init(){this.element.addEventListener("click",this.handleClick.bind(this))}handleClick(e){const t=this.element,n=this.target,a=this.config.class;s(n,a)?o([t,n],a):(i([t,n],a),document.addEventListener("click",(function s(i){i===e||i.target===n||n.contains(i.target)||(o([t,n],a),document.removeEventListener("click",s))})))}},Watch:function(t){!function(e,t){new window.IntersectionObserver((function(e){e.forEach((e=>{e.isIntersecting&&e.target.classList.add(t)}))}),{threshold:1}).observe(e)}(t,{class:"is-visible",...e(t)}.class)},Modal:class{constructor(e){const t=e.getAttribute("data-target");t&&(this.target=document.querySelector(t),this.dialog=this.target.querySelector("[data-dialog]"),this.element=e,this.close=document.querySelectorAll("[data-close]"),this.init())}init(){this.element.addEventListener("click",this.show.bind(this)),this.target.addEventListener("click",(e=>{this.dialog.contains(e.target)||this.hide()})),t(this.close,(e=>{e.addEventListener("click",this.hide.bind(this))}))}hide(){const e=function(e){if(!e)return 0;const t=window.getComputedStyle(e),n=t.transitionDuration,s=t.transitionDelay;return parseFloat(n)||parseFloat(s)?1e3*(parseFloat(s.split(",")[0])+parseFloat(n.split(",")[0])):0}(this.target)+5;this.escape&&(this.escape(),this.escape=null),this.target.classList.remove(m),setTimeout((()=>{document.body.classList.remove(g),document.body.style.removeProperty(u),document.body.style.paddingRight="",document.body.style.overflow=""}),e)}show(){const e=function(){const e=document.createElement("div");e.classList.add("modal-scrollbar-measure"),document.body.appendChild(e);const t=e.getBoundingClientRect().width-e.clientWidth;return document.body.removeChild(e),t}()+"px";var t,n,s;document.body.classList.add(g),document.body.style.setProperty(u,e),document.body.style.paddingRight=e,document.body.style.overflow="hidden",this.target.classList.add(m),this.escape=(t=window,n="keydown",s=e=>{"Escape"===e.key&&this.hide()},void t.addEventListener(n,(function e(i){s(i),t.removeEventListener(n,e)})))}},Group:class{constructor(e){const t=e.getAttribute("data-target"),n=document.querySelectorAll(t);this.prev=null,n&&(this.targets=n,this.elements=e.querySelectorAll("[data-class]"),this.init())}init(){t(this.elements,(e=>{const t=e.getAttribute("data-class");e.addEventListener("click",(e=>{this.handleClick(e,t)}))}))}handleClick(e,t){e.preventDefault();const n=this.targets,s=e.target,a=this.prev;a&&(o(n,a.previous),o(a.el,"is-active")),i(n,t),i(s,"is-active"),this.prev={previous:t,el:s}}},Dropdown:function(e){e.addEventListener("click",(t=>{const n=e.parentNode;s(n,y)?o([e,n],y):(i([e,n],y),document.addEventListener("click",(function s(i){i===t||i.target===n||n.contains(i.target)||(o([e,n],y),document.removeEventListener("click",s))})))}))}};return t({add:i,remove:o,toggle:a},((e,t)=>{h[t]=function(t){const n=t.getAttribute("data-target"),s=t.getAttribute("data-class")||"is-active",i=n?document.querySelectorAll(n):[t];i&&s&&t.addEventListener("click",(()=>{e(i,s)}))}})),t(h,((e,n)=>{const s=n.toLowerCase();t(document.querySelectorAll(`[data-wjs="${s}"]`),(t=>{new e(t)}))})),h},"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).whale=t(),function(){const e=document.getElementById("playerHistory"),t=document.getElementById("program"),n=document.getElementById("showWeeklySchedule"),s=document.getElementById("showRecentlyPlayed"),i=document.getElementById("closeHistory"),o=document.getElementById("blog"),a=document.querySelector(".modal-info");function r(e){var t=e.split(":");return 60*+t[0]*60+60*+t[1]}const c={day:86400,hour:3600,minute:60,second:1},l=e=>{const t=new Intl.RelativeTimeFormat,n=(e=>(Date.now()-e)/1e3)(e),{value:s,unit:i}=(e=>{for(const[t,n]of Object.entries(c))if(e>=n||"second"===t)return{value:-1*Math.floor(e/n),unit:t}})(n);return t.format(s,i)};function d(e="America/Hermosillo"){let t=new Date,n=t.toLocaleTimeString([],{timeStyle:"short",timeZone:e}),s=t.toLocaleString("es",{weekday:"long",timeZone:e});return{date:t,time:n,week:s}}function u(e,t){if(!e||!t)return;const n=t.querySelector(".set-artist"),s=t.querySelector(".set-title"),i=t.querySelector(".set-album"),o=t.querySelector(".set-art"),a=t.querySelector(".set-year"),r=t.querySelector(".set-duration"),c=t.querySelector(".set-bg");n&&(n.innerText=e.song.artist),s&&(s.innerText=e.song.title),i&&(i.innerText=e.song.album),o&&(o.src=e.song.art),a&&(a.innerText=e.song.custom_fields.year),r&&(r.innerText=function(e){const t=e%60;function n(e){return e.toString().padStart(2,"0")}return`${n(Math.floor(e/60))}:${n(t)}`}(e.duration)),c&&c.setAttribute("style","background-image: url("+e.song.art+")")}function m(e,t,n){let s="";e.slice(0,t).forEach(((e,t)=>{let n=e.played_at,i=new Date(1e3*n);s+=`\n        <div class="history-item" style="--his-bg: url(${e.song.art})">\n          <div class="history-meta">\n            <h3 class="history-title">${e.song.title}</h3>\n            <div class="history-artist">${e.song.artist}</div>\n            <span class="history-timeago">${l(i)}</span>\n            <button class='player-modal' data-modal='song_history' data-index='${t}'>\n              <i class="fa-solid fa-circle-info"></i>\n            </button>\n          </div>\n        </div>\n      `})),n.innerHTML=s,function(){if(!a)return;const e=document.querySelectorAll(".player-modal"),t=document.querySelector(".modal-close"),n=document.querySelector(".modal-mask");e.forEach((e=>{e.onclick=()=>{e.dataset.index?B(e.dataset.modal,e.dataset.index):B(e.dataset.modal),a.classList.add("is-active")}})),t.onclick=()=>{a.classList.remove("is-active")},n.onclick=()=>{a.classList.remove("is-active")}}()}const g=document.querySelector(".player"),y=document.querySelector(".player-audio"),h="https://stream.radioani.me/listen/japanisu/";if(y){const C=y.querySelectorAll(".player-source");let M=localStorage.getItem("radioSrc")||"radio.mp3";C.forEach((e=>{e.dataset.type==M?e.classList.add("is-active"):e.classList.remove("is-active"),e.onclick=()=>{!function(e){let t=e.dataset.type;C.forEach((e=>{e.dataset.type==t?e.classList.add("is-active"):e.classList.remove("is-active")})),M!=t&&(localStorage.setItem("radioSrc",t),S(),H.src=h+t,w()),M=t}(e)}}));const H=new Audio(h+M),j=y.querySelector(".player-volume");j.addEventListener("change",(function(e){H.volume=e.currentTarget.value/100,localStorage.setItem("player_vol",H.volume)}),!1);var v=localStorage.getItem("player_vol");v&&(H.volume=v,j.value=100*v);var f=y.querySelector(".player-toggle");"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("play",(function(){w()})),navigator.mediaSession.setActionHandler("pause",(function(){S()})));var p=null;function w(){H.load(),g.classList.add("is-playing"),H.play(),f.innerHTML='<svg class="i i-pause" viewBox="0 0 24 24"><path d="M5 4h4v16H5Zm10 0h4v16h-4Z"></path></svg>',null==p&&function(e){e.crossOrigin="anonymous";const t=new AudioContext,n=t.createMediaElementSource(e),s=t.createAnalyser();n.connect(s),n.connect(t.destination);const i=new Uint8Array(s.frequencyBinCount);s.getByteFrequencyData(i);const o=document.querySelector(".visualizer");for(let e=0;e<20;e++){const t=document.createElement("DIV");t.setAttribute("id","bar"+e),t.setAttribute("class","visualizer-item"),o.appendChild(t)}!function e(){s.getByteFrequencyData(i);const t=o.dataset.fftSize;t&&(s.fftSize=t);for(let e=0;e<20;e++){const t=i[2*(e+10)],n=document.querySelector("#bar"+e);if(!n)continue;const s=Math.max(4,t||0);n.style.height=s+"px"}window.requestAnimationFrame(e)}()}(H),p="init visualizer"}function S(){g.classList.remove("is-playing"),H.pause(),f.innerHTML='<svg class="i i-play" viewBox="0 0 24 24"><path d="m7 3 14 9-14 9z"></path></svg>'}f.addEventListener("click",(()=>{H.paused?w():S()}),!1)}const L="https://stream.radioani.me/api/nowplaying_static/japanisu.json",b="https://stream.radioani.me/api/live/nowplaying/sse?cf_connect="+JSON.stringify({subs:{"station:japanisu":{}}});function E(t,n=!1){document.querySelector(".template");let a=t.song_history,r=g.querySelector(".song-now",g),c=g.querySelector(".song-next",g),l=t.now_playing.remaining,d=t.now_playing.duration;const y=document.querySelector(".player-control .circle");let h=100/d,v=100-l/d*100;let f;n?(clearInterval(f),f=setInterval((function(){v+=h,y.setAttribute("stroke-dasharray",v+", 100"),n&&v>=100&&clearInterval(f)}),1e3)):y.setAttribute("stroke-dasharray",v+", 100");let p=document.querySelector(".posterA"),w=document.querySelector(".posterB");p&&p.src&&(p.crossOrigin="Anonymous",p.src=t.now_playing.song.art,function(e,t){let n=new ColorThief;t.complete?e.setAttribute("style",`--accent: rgb(${n.getColor(t)})`):t.addEventListener("load",(function(){e.setAttribute("style",`--accent: rgb(${n.getColor(t)})`)}))}(document.body,p)),w&&w.src&&(w.crossOrigin="Anonymous",w.src=t.song_history[0].song.art),r&&u(t.now_playing,r),c&&u(t.playing_next,c);var S=i.classList.contains("is-active")?15:4;e&&(i.onclick=()=>{i.classList.remove("is-active"),o.classList.remove("has-history"),m(a,4,e),s.innerText="Ver más"},s.onclick=()=>{i.classList.contains("is-active")?(i.classList.remove("is-active"),o.classList.remove("has-history"),m(a,4,e),s.innerText="Ver más"):(i.classList.add("is-active"),o.classList.add("has-history"),m(a,15,e),s.innerText="Ver menos")},m(a,S,e)),"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:t.now_playing.song.title,artist:t.now_playing.song.artist,album:t.now_playing.song.album,artwork:[{src:t.now_playing.song.art,sizes:"96x96",type:"image/png"},{src:t.now_playing.song.art,sizes:"128x128",type:"image/png"},{src:t.now_playing.song.art,sizes:"192x192",type:"image/png"},{src:t.now_playing.song.art,sizes:"256x256",type:"image/png"}]})),document.querySelectorAll(".player-meta").forEach((e=>{var t=e.querySelector(".song-title"),n=t.offsetWidth,s=e.offsetWidth;e.setAttribute("style","--title-width:"+s+"px"),n>s?t.classList.add("song-very-long"):t.classList.remove("song-very-long")}))}const k=document.getElementById("listeners");function q(e){return`\n      <div class="upcoming bg-dark shadow-xl" data-start="${e.start}" data-end="${e.end}" data-weekday="${e.day}" >\n        <img class="upcoming-image fit-image" src="${e.poster}" alt="${e.title}">\n        <div class="upcoming-data fs-7 relative py-.75 px-1.25">\n          <div class="upcoming-title fw-500 color-title nowrap">${e.title}</div>\n          <div class="upcoming-snippet fw-500 my-1">${e.snippet}</div>\n          <div class="upcoming-time">${e.start} - ${e.end}</div>\n        </div>\n      </div>\n    `}function A(){let e=d(),n=t.querySelectorAll(".program-program"),s=r(e.time);n.forEach((t=>{if(t.dataset.week==e.week){t.querySelectorAll(".upcoming").forEach((e=>{let t=r(e.dataset.start),n=r(e.dataset.end);t<=s&&n>s?e.classList.add("is-online"):e.classList.remove("is-online")}))}}))}function x(){t.classList.add("program","grid","l:cols-7","cols-1","is-active"),t.querySelectorAll(".program-program").forEach((e=>{let t=e.dataset.week;var n,s,i;e.innerHTML=(n=currentSchedule,s=t,i="",n.forEach((e=>{e.day==s&&(i+=q(e))})),i)})),t.classList.remove("none")}document.querySelector("[data-sse]")?new EventSource(b).onmessage=e=>{const t=JSON.parse(e.data)?.pub?.data?.np||null;t&&(E(t),k.innerText=t.listeners.current)}:(!function e(){fetch(L).then((e=>e.json())).then((t=>{E(t,!0);let n=t.now_playing.remaining;setTimeout(e,1e3*(n+1))})).catch((e=>console.log(e)))}(),k&&function e(){fetch(L).then((e=>e.json())).then((t=>{let n=t.listeners.current;k.innerText=n,setTimeout(e,1e3*(k.dataset.update||5))})).catch((e=>console.log(e)))}()),t&&n.addEventListener("click",(()=>{n.classList.contains("is-active")?(n.classList.remove("is-active"),t.classList.add("none"),t.classList.remove("program","grid","l:cols-7","cols-1","is-active"),t.querySelectorAll(".program-program").forEach((e=>{e.innerHTML=""})),clearInterval(A)):(n.classList.add("is-active"),x(),A(),setInterval(A,1e4))}),!1);const T=document.getElementById("renderUpcoming");function I(){let e=d();T.querySelectorAll(".upcoming").forEach((t=>{let n=(r(t.dataset.start)-r(e.time))/16+48,s=(r(t.dataset.start)-(r(e.time)-86400))/16+48;t.setAttribute("style",`transform: translateX(${t.dataset.weekday==e.week?n:s}px)`),t.classList.add("is-loaded")}))}T&&(I(),setInterval(I,2e4)),function e(){let t=d(),n=r("24:00")-r(t.time);T&&(T.innerHTML=function(e){let t=d();var n="";let s=(i=t.week,o="","lunes"==i?o="martes":"martes"==i?o="miércoles":"miércoles"==i?o="jueves":"jueves"==i?o="viernes":"viernes"==i?o="sábado":"sábado"==i?o="domingo":"domingo"==i&&(o="lunes"),o);var i,o;return e.forEach((e=>{e.day!=t.week&&e.day!=s||(n+=q(e))})),n}(currentSchedule)),I(),setTimeout(e,1e3*(0===n?10:n))}();const F=document.querySelector(".header-player");function _(){return null!==(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||null)}function $(e){var t;_()?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():(t=document.documentElement).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}window.innerWidth>760&&function(){if(F){var e=F.offsetHeight;window.addEventListener("scroll",(function(){window.scrollY>F.offsetTop+e?(F.nextElementSibling.setAttribute("style","margin-top:"+e+"px"),F.classList.add("header-sticky","fixed","z-100","t-0","x-0")):(F.classList.remove("header-sticky","fixed","z-100","t-0","x-0"),F.nextElementSibling.removeAttribute("style"))}))}}();const z=document.getElementById("fullscreen");function B(e,t){fetch(L).then((e=>e.json())).then((n=>{u(t?n[e][t]:n[e],a)})).catch((e=>console.log(e)))}z.onclick=()=>{$()},["fullscreenchange","webkitfullscreenchange","mozfullscreenchange"].forEach((e=>document.addEventListener(e,(function(){_()?(document.documentElement.classList.add("is-fullscreen"),z.innerHTML='<i class="fa-solid fa-compress"></i>'):(document.documentElement.classList.remove("is-fullscreen"),z.innerHTML='<i class="fa-solid fa-expand"></i>')}),!1))),document.body.classList.remove("preload")}();