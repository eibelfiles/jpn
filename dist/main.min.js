//! Japanisu v9.4
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).whale=e()}(this,(function(){"use strict";function t({dataset:t}){const e={};return Object.keys(t).forEach((i=>{var n;e[i]="true"===(n=t[i])||"false"!==n&&(+n+""===n?+n:"null"===n||""===n?null:n)})),e}function e(t,e){let i=0;if("object"==typeof(n=t)&&"number"==typeof n.length){const n=t.length;for(;i<n&&!1!==e.call(t[i],t[i],i);i++);}else for(i in t)if(!1===e.call(t[i],t[i],i))break;var n;return t}function i(t){return function(i,n){i.length||(i=[i]),e(i,(function(e){e.classList[t](n)}))}}function n(t,e){return t.classList.contains(e)}const s=i("add"),o=i("remove"),c=i("toggle");const a="is-active";const l={outside:!1},r="is-active";const d={class:"is-active"};const u="--ws-offset-scroll",h="is-active",g="modal-is-open";const m="is-active";const v={Tab:function(t){let i;e(t.querySelectorAll("[data-target]"),(t=>{const e=document.getElementById(t.dataset.target);n(t,a)&&(i=[t,e],s(e,a)),function(t,e,i){t.addEventListener(e,i)}(t,"click",(()=>{const n=[t,e];i&&o(i,a),i=n,s(i,a)}))}))},Accordion:class{constructor(e){this.element=e,this.active=!1;const i=e.querySelectorAll("[data-toggle]");this.config={...l,...t(e)},i&&(this.titles=i,this.init())}init(){e(this.titles,(t=>{const e=t.parentNode,i=e.parentNode.querySelectorAll("[data-item]");t.addEventListener("click",(t=>{const c=this.config.outside?e=>{t===e||this.element.contains(e.target)||i.length&&(o(i,r),this.active=!1)}:()=>{};this.active||(document.addEventListener("click",c),this.active=!0),n(e,r)?o(e,r):(i.length&&o(i,r),s(e,r))}))}))}},Outside:class{constructor(e){this.element=e;const i=t(e);this.config={...d,...i},this.target=i.target?document.getElementById(i.target):this.element,this.init()}init(){this.element.addEventListener("click",this.handleClick.bind(this))}handleClick(t){const e=this.element,i=this.target,c=this.config.class;n(i,c)?o([e,i],c):(s([e,i],c),document.addEventListener("click",(function n(s){s===t||s.target===i||i.contains(s.target)||(o([e,i],c),document.removeEventListener("click",n))})))}},Watch:function(e){!function(t,e){new window.IntersectionObserver((function(t){t.forEach((t=>{t.isIntersecting&&t.target.classList.add(e)}))}),{threshold:1}).observe(t)}(e,{class:"is-visible",...t(e)}.class)},Modal:class{constructor(t){const e=t.getAttribute("data-target");e&&(this.target=document.querySelector(e),this.dialog=this.target.querySelector("[data-dialog]"),this.element=t,this.close=document.querySelectorAll("[data-close]"),this.init())}init(){this.element.addEventListener("click",this.show.bind(this)),this.target.addEventListener("click",(t=>{this.dialog.contains(t.target)||this.hide()})),e(this.close,(t=>{t.addEventListener("click",this.hide.bind(this))}))}hide(){const t=function(t){if(!t)return 0;const e=window.getComputedStyle(t),i=e.transitionDuration,n=e.transitionDelay;return parseFloat(i)||parseFloat(n)?1e3*(parseFloat(n.split(",")[0])+parseFloat(i.split(",")[0])):0}(this.target)+5;this.escape&&(this.escape(),this.escape=null),this.target.classList.remove(h),setTimeout((()=>{document.body.classList.remove(g),document.body.style.removeProperty(u),document.body.style.paddingRight="",document.body.style.overflow=""}),t)}show(){const t=function(){const t=document.createElement("div");t.classList.add("modal-scrollbar-measure"),document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e}()+"px";var e,i,n;document.body.classList.add(g),document.body.style.setProperty(u,t),document.body.style.paddingRight=t,document.body.style.overflow="hidden",this.target.classList.add(h),this.escape=(e=window,i="keydown",n=t=>{"Escape"===t.key&&this.hide()},void e.addEventListener(i,(function t(s){n(s),e.removeEventListener(i,t)})))}},Group:class{constructor(t){const e=t.getAttribute("data-target"),i=document.querySelectorAll(e);this.prev=null,i&&(this.targets=i,this.elements=t.querySelectorAll("[data-class]"),this.init())}init(){e(this.elements,(t=>{const e=t.getAttribute("data-class");t.addEventListener("click",(t=>{this.handleClick(t,e)}))}))}handleClick(t,e){t.preventDefault();const i=this.targets,n=t.target,c=this.prev;c&&(o(i,c.previous),o(c.el,"is-active")),s(i,e),s(n,"is-active"),this.prev={previous:e,el:n}}},Dropdown:function(t){t.addEventListener("click",(e=>{const i=t.parentNode;n(i,m)?o([t,i],m):(s([t,i],m),document.addEventListener("click",(function n(s){s===e||s.target===i||i.contains(s.target)||(o([t,i],m),document.removeEventListener("click",n))})))}))}};return e({add:s,remove:o,toggle:c},((t,e)=>{v[e]=function(e){const i=e.getAttribute("data-target"),n=e.getAttribute("data-class")||"is-active",s=i?document.querySelectorAll(i):[e];s&&n&&e.addEventListener("click",(()=>{t(s,n)}))}})),e(v,((t,i)=>{const n=i.toLowerCase();e(document.querySelectorAll(`[data-wjs="${n}"]`),(e=>{new t(e)}))})),v}));!function(){function e(e){return document.getElementById(e)}function t(e,t){return(t||document).querySelector(e)}function n(e){var t=e.split(":");return 60*+t[0]*60+60*+t[1]}const s={day:86400,hour:3600,minute:60,second:1},i=e=>{const t=new Intl.RelativeTimeFormat,n=(e=>(Date.now()-e)/1e3)(e),{value:i,unit:a}=(e=>{for(const[t,n]of Object.entries(s))if(e>=n||"second"===t)return{value:-1*Math.floor(e/n),unit:t}})(n);return t.format(i,a)};function a(e="America/Hermosillo"){let t=new Date,n=t.toLocaleTimeString([],{timeStyle:"short",timeZone:e}),s=t.toLocaleString("es",{weekday:"long",timeZone:e});return{date:t,time:n,week:s}}function o(e,t){let n="";for(const s of e.slice(0,t)){let e=s.played_at,t=new Date(1e3*e);n+=`\n        <div class="history-item" style="--his-bg: url(${s.song.art})">\n          <div class="history-meta">\n            <h3 class="history-title">${s.song.title}</h3>\n            <div class="history-artist">${s.song.artist}</div>\n            <span class="history-timeago">${i(t)}</span>\n          </div>\n        </div>\n      `}return n}function r(e,n){let s=t(".song-cover",e),i=t(".song-title",e),a=t(".song-artist",e),o=t(".song-album",e);s&&(s.src=n.art),i&&(i.innerText=n.title),a&&(a.innerText=n.artist),o&&(o.innerText=n.album)}const l=t(".player"),c=t(".player-audio");if(c&&c.dataset.src){const H=new Audio(c.dataset.src),$=t(".player-volume",c);$.addEventListener("change",(function(e){H.volume=e.currentTarget.value/100,localStorage.setItem("player_vol",H.volume)}),!1);var d=localStorage.getItem("player_vol");d&&(H.volume=d,$.value=100*d);var u=t(".player-toggle",c);"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("play",(function(){m()})),navigator.mediaSession.setActionHandler("pause",(function(){y()})));var g=null;function m(){H.load(),l.classList.toggle("is-playing"),H.play(),u.innerHTML='<svg class="i i-pause" viewBox="0 0 24 24"><path d="M5 4h4v16H5Zm10 0h4v16h-4Z"></path></svg>',null==g&&function(e){e.crossOrigin="anonymous";const t=new AudioContext,n=t.createMediaElementSource(e),s=t.createAnalyser();n.connect(s),n.connect(t.destination);const i=new Uint8Array(s.frequencyBinCount);s.getByteFrequencyData(i);const a=document.querySelector(".visualizer");for(let e=0;e<20;e++){const t=document.createElement("DIV");t.setAttribute("id","bar"+e),t.setAttribute("class","visualizer-item"),a.appendChild(t)}!function e(){s.getByteFrequencyData(i);const t=a.dataset.fftSize;t&&(s.fftSize=t);for(let e=0;e<20;e++){const t=i[2*(e+10)],n=document.querySelector("#bar"+e);if(!n)continue;const s=Math.max(4,t||0);n.style.height=s+"px"}window.requestAnimationFrame(e)}()}(H),g="init visualizer"}function y(){l.classList.toggle("is-playing"),H.pause(),u.innerHTML='<svg class="i i-play" viewBox="0 0 24 24"><path d="m7 3 14 9-14 9z"></path></svg>'}u.addEventListener("click",(()=>{H.paused?m():y()}),!1)}const p="https://stream.radioani.me/api/nowplaying_static/japanisu.json",v=e("playerHistory");!function e(){fetch(p).then((e=>e.json())).then((n=>{let s=n.song_history,i=t(".song-now",l),a=t(".song-next",l),c=n.now_playing.remaining,d=t(".posterA"),u=t(".posterB");d&&d.src&&(d.crossOrigin="Anonymous",d.src="https://images.weserv.nl/?url="+encodeURIComponent(n.now_playing.song.art),function(e,t){let n=new ColorThief;t.complete?e.setAttribute("style",`--accent: rgb(${n.getColor(t)})`):t.addEventListener("load",(function(){e.setAttribute("style",`--accent: rgb(${n.getColor(t)})`)}))}(document.body,d)),u&&u.src&&(u.crossOrigin="Anonymous",u.src="https://images.weserv.nl/?url="+encodeURIComponent(n.playing_next.song.art)),i&&r(i,n.now_playing.song),a&&r(a,n.playing_next.song);var g=S.classList.contains("is-active")?15:4;v&&(S.onclick=()=>{S.classList.remove("is-active"),b.classList.remove("has-history"),v.innerHTML=o(s,4),x.innerText="Ver más"},x.onclick=()=>{S.classList.contains("is-active")?(S.classList.remove("is-active"),b.classList.remove("has-history"),v.innerHTML=o(s,4),x.innerText="Ver más"):(S.classList.add("is-active"),b.classList.add("has-history"),v.innerHTML=o(s,15),x.innerText="Ver menos")},v.innerHTML=o(s,g)),"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:n.now_playing.song.title,artist:n.now_playing.song.artist,album:n.now_playing.song.album,artwork:[{src:n.now_playing.song.art,sizes:"96x96",type:"image/png"},{src:n.now_playing.song.art,sizes:"128x128",type:"image/png"},{src:n.now_playing.song.art,sizes:"192x192",type:"image/png"},{src:n.now_playing.song.art,sizes:"256x256",type:"image/png"}]})),document.querySelectorAll(".player-meta").forEach((e=>{var n=t(".song-title",e),s=n.offsetWidth,i=e.offsetWidth;e.setAttribute("style","--title-width:"+i+"px"),s>i?n.classList.add("song-very-long"):n.classList.remove("song-very-long")})),setTimeout(e,1e3*c)})).catch((e=>console.log(e)))}();const f=e("listeners");function h(e){return`\n      <div class="upcoming bg-dark shadow-xl" data-start="${e.start}" data-end="${e.end}" data-weekday="${e.day}" >\n        <img class="upcoming-image fit-image" src="${e.poster}" alt="${e.title}">\n        <div class="upcoming-data fs-7 relative py-.75 px-1.25">\n          <div class="upcoming-title fw-500 color-title nowrap">${e.title}</div>\n          <div class="upcoming-snippet fw-500 my-1">${e.snippet}</div>\n          <div class="upcoming-time">${e.start} - ${e.end}</div>\n        </div>\n      </div>\n    `}f&&function e(){fetch(p).then((e=>e.json())).then((t=>{let n=t.listeners.current;f.innerText=n,setTimeout(e,1e3*(f.dataset.update||5))})).catch((e=>console.log(e)))}();const w=e("program"),L=e("showWeeklySchedule"),x=e("showRecentlyPlayed"),S=e("closeHistory"),b=e("blog");function A(){let e=a(),t=w.querySelectorAll(".program-program"),s=n(e.time);t.forEach((t=>{if(t.dataset.week==e.week){t.querySelectorAll(".upcoming").forEach((e=>{let t=n(e.dataset.start),i=n(e.dataset.end);t<=s&&i>s?e.classList.add("is-online"):e.classList.remove("is-online")}))}}))}function k(){w.classList.add("program","grid","l:cols-7","cols-1","is-active"),w.querySelectorAll(".program-program").forEach((e=>{let t=e.dataset.week;var n,s,i;e.innerHTML=(n=currentSchedule,s=t,i="",n.forEach((e=>{e.day==s&&(i+=h(e))})),i)})),w.classList.remove("none")}w&&L.addEventListener("click",(()=>{L.classList.contains("is-active")?(L.classList.remove("is-active"),w.classList.add("none"),w.classList.remove("program","grid","l:cols-7","cols-1","is-active"),w.querySelectorAll(".program-program").forEach((e=>{e.innerHTML=""})),clearInterval(A)):(L.classList.add("is-active"),k(),A(),setInterval(A,1e4))}),!1);const T=e("renderUpcoming");function E(){let e=a();T.querySelectorAll(".upcoming").forEach((t=>{let s=(n(t.dataset.start)-n(e.time))/16+48,i=(n(t.dataset.start)-(n(e.time)-86400))/16+48;t.setAttribute("style",`transform: translateX(${t.dataset.weekday==e.week?s:i}px)`),t.classList.add("is-loaded")}))}T&&(E(),setInterval(E,2e4)),function e(){let t=a(),s=n("24:00")-n(t.time);T&&(T.innerHTML=function(e){let t=a();var n="";let s=(i=t.week,o="","lunes"==i?o="martes":"martes"==i?o="miércoles":"miércoles"==i?o="jueves":"jueves"==i?o="viernes":"viernes"==i?o="sábado":"sábado"==i?o="domingo":"domingo"==i&&(o="lunes"),o);var i,o;return e.forEach((e=>{e.day!=t.week&&e.day!=s||(n+=h(e))})),n}(currentSchedule)),E(),setTimeout(e,1e3*(0===s?10:s))}();const _=document.querySelector(".header-player");window.innerWidth>760&&function(){if(_){var e=_.offsetHeight;window.addEventListener("scroll",(function(){window.scrollY>_.offsetTop+e?(_.nextElementSibling.setAttribute("style","margin-top:"+e+"px"),_.classList.add("header-sticky","fixed","z-100","t-0","x-0")):(_.classList.remove("header-sticky","fixed","z-100","t-0","x-0"),_.nextElementSibling.removeAttribute("style"))}))}}(),t("[data-flickity]")&&Defer.js("https://cdn.jsdelivr.net/npm/flickity@2/dist/flickity.pkgd.min.js","flickity",100,null,!0),Defer.dom(".lazyload",0,"is-loaded"),document.body.classList.remove("preload")}();