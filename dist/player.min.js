//! Japanisu Player v9.5
!function(){function e(e,t){return(t||document).querySelector(e)}function t(t,n){let a=e(".song-cover",t),i=e(".song-title",t),o=e(".song-artist",t),s=e(".song-album",t);a&&(a.src=n.art),i&&(i.innerText=n.title),o&&(o.innerText=n.artist),s&&(s.innerText=n.album)}function n(e){e<10?s.innerHTML='<i class="fa-solid fa-volume-off"></i>':e<60&&e>10?s.innerHTML='<i class="fa-solid fa-volume-low"></i>':e>60&&(s.innerHTML='<i class="fa-solid fa-volume-high"></i>')}const a=e(".player"),i=e(".player-audio"),o=e(".player-volume-toggle"),s=e(".player-volume-toggle-btn"),l="https://stream.radioani.me/listen/japanisu/";if(i){const p=a.querySelectorAll(".player-source");let y=localStorage.getItem("radioSrc")||"radio.mp3";p.forEach((e=>{e.dataset.type==y?e.classList.add("is-active"):e.classList.remove("is-active"),e.onclick=()=>{!function(e){let t=e.dataset.type;p.forEach((e=>{e.dataset.type==t?e.classList.add("is-active"):e.classList.remove("is-active")})),y!=t&&(localStorage.setItem("radioSrc",t),d(),m.src=l+t,u()),y=t}(e)}}));const m=new Audio(l+y);o&&s&&(s.onclick=()=>{o.classList.toggle("is-active")});const v=e(".player-volume",i);v.addEventListener("change",(function(e){m.volume=e.currentTarget.value/100,o&&s&&n(e.currentTarget.value),localStorage.setItem("player_vol",m.volume)}),!1);var r=localStorage.getItem("player_vol");r&&(m.volume=r,v.value=100*r),o&&s&&n(v.value);var c=e(".player-toggle",i),g=null;function u(){m.load(),a.classList.toggle("is-playing"),m.play(),c.innerHTML='<svg class="i i-pause" viewBox="0 0 24 24"><path d="M5 4h4v16H5Zm10 0h4v16h-4Z"></path></svg>',null==g&&function(e){e.crossOrigin="anonymous";const t=new AudioContext,n=t.createMediaElementSource(e),a=t.createAnalyser();n.connect(a),n.connect(t.destination);const i=new Uint8Array(a.frequencyBinCount);a.getByteFrequencyData(i);const o=document.querySelector(".visualizer");for(let e=0;e<20;e++){const t=document.createElement("DIV");t.setAttribute("id","bar"+e),t.setAttribute("class","visualizer-item"),o.appendChild(t)}!function e(){a.getByteFrequencyData(i);const t=o.dataset.fftSize;t&&(a.fftSize=t);for(let e=0;e<20;e++){const t=i[2*(e+10)],n=document.querySelector("#bar"+e);if(!n)continue;const a=Math.max(4,t||0);n.style.height=a+"px"}window.requestAnimationFrame(e)}()}(m),g="init visualizer"}function d(){a.classList.toggle("is-playing"),m.pause(),c.innerHTML='<svg class="i i-play" viewBox="0 0 24 24"><path d="m7 3 14 9-14 9z"></path></svg>'}"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("play",(function(){u()})),navigator.mediaSession.setActionHandler("pause",(function(){d()}))),c.addEventListener("click",(()=>{m.paused?u():d()}),!1)}!function n(){fetch("https://stream.radioani.me/api/nowplaying_static/japanisu.json").then((e=>e.json())).then((i=>{let o=i.song_history,s=(l="playerHistory",document.getElementById(l));var l;let r=e(".song-now",a),c=e(".song-next",a),g=i.now_playing.remaining,u=e(".player-poster");u&&u.src&&(u.crossOrigin="Anonymous",u.src="https://images.weserv.nl/?url="+encodeURIComponent(i.now_playing.song.art),function(e,t){let n=new ColorThief;t.complete?e.setAttribute("style",`--accent: rgb(${n.getColor(t)})`):t.addEventListener("load",(function(){e.setAttribute("style",`--accent: rgb(${n.getColor(t)})`)}))}(document.body,u)),r&&t(r,i.now_playing.song),c&&t(c,i.playing_next.song),s&&(s.innerHTML=createHistory(o,s.dataset.results||5)),document.querySelectorAll(".player-meta").forEach((t=>{var n=e(".song-title",t),a=n.offsetWidth,i=t.offsetWidth;t.setAttribute("style","--title-width:"+i+"px"),a>i?n.classList.add("song-very-long"):n.classList.remove("song-very-long")})),"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:i.now_playing.song.title,artist:i.now_playing.song.artist,album:i.now_playing.song.album,artwork:[{src:i.now_playing.song.art,sizes:"96x96",type:"image/png"},{src:i.now_playing.song.art,sizes:"128x128",type:"image/png"},{src:i.now_playing.song.art,sizes:"192x192",type:"image/png"},{src:i.now_playing.song.art,sizes:"256x256",type:"image/png"}]})),setTimeout(n,1e3*g)})).catch((e=>console.log(e)))}()}();