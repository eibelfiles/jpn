/*! Japanisu.main - v1.6.0 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).whale=e()}(this,(function(){"use strict";function t(t,e,i){return t.addEventListener(e,i),()=>{t.removeEventListener(e,i)}}function e({dataset:t}){const e={};return Object.keys(t).forEach((i=>{var s;e[i]="true"===(s=t[i])||"false"!==s&&(+s+""===s?+s:"null"===s||""===s?null:s)})),e}function i(t,e){let i=0;if("object"==typeof(s=t)&&"number"==typeof s.length){const s=t.length;for(;i<s&&!1!==e.call(t[i],t[i],i);i++);}else for(i in t)if(!1===e.call(t[i],t[i],i))break;var s;return t}function s(t){return function(e,s){e.length||(e=[e]),i(e,(function(e){e.classList[t](s)}))}}function n(t,e){return t.classList.contains(e)}const o=s("add"),c=s("remove"),l=s("toggle");const a={start:1,time:10};const r="is-active";const d={width:600,height:400};class h{constructor(i,s={}){this.element=i,this.config={...d,...s,...e(i)},t(i,"click",this.handleClick.bind(this))}handleClick(t){t.preventDefault();const e=this.config.width,i=this.config.height,s="top="+(window.screen.height-i)/2+", left="+(window.screen.width-e)/2+", width="+e+", height="+i;window.open(this.element.href,"",s)}}const u={outside:!1},f="is-active";const g={class:"is-active"};const m="--ws-offset-scroll",v="is-active",p="modal-is-open";const w="is-active";const y={Tab:function(e){let s;i(e.querySelectorAll("[data-target]"),(e=>{const i=document.getElementById(e.dataset.target);n(e,r)&&(s=[e,i],o(i,r)),t(e,"click",(()=>{const t=[e,i];s&&c(s,r),s=t,o(s,r)}))}))},Counter:class{constructor(i){this.config={...a,...e(i)},this.element=i,this.count=this.config.start,this.active=!1,this.setContent(this.count++),this.unsubscribe=t(window,"scroll",this.handleScroll.bind(this)),this.handleScroll()}handleScroll(){(function(t){const e=t.offsetTop,i=e+t.offsetHeight,s=window.pageYOffset,n=s+window.innerHeight;return i>=s&&e<=n&&i<=n&&e>=s})(this.element)&&(this.interval=setInterval(this.showCounter.bind(this),this.config.time),this.unsubscribe())}setContent(t){this.element.textContent=t}showCounter(){this.setContent(this.count),this.count++>=this.config.end&&clearInterval(this.interval)}},Window:h,Windows:function(t){const i=Array.from(t.querySelectorAll("a")),s=e(t);i.forEach((t=>{new h(t,s)}))},Navbar:class{constructor(t){this.element=t,this.init()}init(){this.translateY=0,this.updateValues(),window.addEventListener("resize",function(){this.updateValues(),this.handleScroll()}.bind(this)),window.addEventListener("scroll",this.handleScroll.bind(this))}updateValues(){this.scrollTop=window.pageYOffset,this.offsetHeight=this.element.offsetHeight}handleScroll(){const t=this.element,e=this.offsetHeight,i=window.pageYOffset,s=i-this.scrollTop;let n=this.translateY+s;t.classList[Math.abs(s)>=e?"add":"remove"]("exced-scroll"),n>=e?n=e:n<=0&&(n=0),t.style.transform="translateY("+n/e*-100+"%)",this.translateY=n,this.scrollTop=i}},Accordion:class{constructor(t){this.element=t,this.active=!1;const i=t.querySelectorAll("[data-toggle]");this.config={...u,...e(t)},i&&(this.titles=i,this.init())}init(){i(this.titles,(t=>{const e=t.parentNode,i=e.parentNode.querySelectorAll("[data-item]");t.addEventListener("click",(t=>{t.preventDefault();const s=this.config.outside?e=>{t===e||this.element.contains(e.target)||i.length&&(c(i,f),this.active=!1)}:()=>{};this.active||(document.addEventListener("click",s),this.active=!0),n(e,f)?c(e,f):(i.length&&c(i,f),o(e,f))}))}))}},Outside:class{constructor(t){this.element=t;const i=e(t);this.config={...g,...i},this.target=i.target?document.getElementById(i.target):this.element,this.init()}init(){this.element.addEventListener("click",this.handleClick.bind(this))}handleClick(t){const e=this.element,i=this.target,s=this.config.class;n(i,s)?c([e,i],s):(o([e,i],s),document.addEventListener("click",(function n(o){o===t||o.target===i||i.contains(o.target)||(c([e,i],s),document.removeEventListener("click",n))})))}},Watch:function(t){!function(t,e){new window.IntersectionObserver((function(t){t.forEach((t=>{t.isIntersecting&&t.target.classList.add(e)}))}),{threshold:1}).observe(t)}(t,{class:"is-visible",...e(t)}.class)},Modal:class{constructor(t){const e=t.getAttribute("data-target");e&&(this.target=document.querySelector(e),this.dialog=this.target.querySelector("[data-dialog]"),this.element=t,this.close=document.querySelectorAll("[data-close]"),this.init())}init(){this.element.addEventListener("click",this.show.bind(this)),this.target.addEventListener("click",(t=>{this.dialog.contains(t.target)||this.hide()})),i(this.close,(t=>{t.addEventListener("click",this.hide.bind(this))}))}hide(){const t=function(t){if(!t)return 0;const e=window.getComputedStyle(t),i=e.transitionDuration,s=e.transitionDelay;return parseFloat(i)||parseFloat(s)?1e3*(parseFloat(s.split(",")[0])+parseFloat(i.split(",")[0])):0}(this.target)+5;this.escape&&(this.escape(),this.escape=null),this.target.classList.remove(v),setTimeout((()=>{document.body.classList.remove(p),document.body.style.removeProperty(m),document.body.style.paddingRight="",document.body.style.overflow=""}),t)}show(){const t=function(){const t=document.createElement("div");t.classList.add("modal-scrollbar-measure"),document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e}()+"px";var e,i,s;document.body.classList.add(p),document.body.style.setProperty(m,t),document.body.style.paddingRight=t,document.body.style.overflow="hidden",this.target.classList.add(v),this.escape=(e=window,i="keydown",s=t=>{"Escape"===t.key&&this.hide()},void e.addEventListener(i,(function t(n){s(n),e.removeEventListener(i,t)})))}},Group:class{constructor(t){const e=t.getAttribute("data-target"),i=document.querySelectorAll(e);this.prev=null,i&&(this.targets=i,this.elements=t.querySelectorAll("[data-class]"),this.init())}init(){i(this.elements,(t=>{const e=t.getAttribute("data-class");t.addEventListener("click",(t=>{this.handleClick(t,e)}))}))}handleClick(t,e){t.preventDefault();const i=this.targets,s=t.target,n=this.prev;n&&(c(i,n.previous),c(n.el,"is-active")),o(i,e),o(s,"is-active"),this.prev={previous:e,el:s}}},Dropdown:function(t){t.addEventListener("click",(e=>{const i=t.parentNode;n(i,w)?c([t,i],w):(o([t,i],w),document.addEventListener("click",(function s(n){n===e||n.target===i||i.contains(n.target)||(c([t,i],w),document.removeEventListener("click",s))})))}))}};return i({add:o,remove:c,toggle:l},((t,e)=>{y[e]=function(e){const i=e.getAttribute("data-target"),s=e.getAttribute("data-class")||"is-active",n=i?document.querySelectorAll(i):[e];n&&s&&e.addEventListener("click",(()=>{t(n,s)}))}})),i(y,((t,e)=>{const s=e.toLowerCase();i(document.querySelectorAll(`[data-wjs="${s}"]`),(e=>{new t(e)}))})),y}));
function e(e){return document.getElementById(e)}function t(e,t){return(t||document).querySelector(e)}function s(e){var t=e.split(":");return 60*+t[0]*60+60*+t[1]}const n={day:86400,hour:3600,minute:60,second:1},i=e=>{const t=new Intl.RelativeTimeFormat,s=(e=>(Date.now()-e)/1e3)(e),{value:i,unit:a}=(e=>{for(const[t,s]of Object.entries(n))if(e>=s||"second"===t)return{value:-1*Math.floor(e/s),unit:t}})(s);return t.format(i,a)};function a(e="America/Hermosillo"){let t=new Date,s=t.toLocaleTimeString([],{timeStyle:"short",timeZone:e}),n=t.toLocaleString("es",{weekday:"long",timeZone:e});return{date:t,time:s,week:n}}function o(e,t){let s="";for(const n of e.slice(0,t)){let e=n.played_at,t=new Date(1e3*e);s+=`\n      <div class="history-item" style="--his-bg: url(${n.song.art})">\n        <div class="history-meta">\n          <h3 class="history-title">${n.song.title}</h3>\n          <div class="history-artist">${n.song.artist}</div>\n          <span class="history-timeago">${i(t)}</span>\n        </div>\n      </div>\n    `}return s}function r(e,s){let n=t(".song-cover",e),i=t(".song-title",e),a=t(".song-artist",e),o=t(".song-album",e);n&&(n.src=s.art),i&&(i.innerText=s.title),a&&(a.innerText=s.artist),o&&(o.innerText=s.album)}const l=t(".player"),c=t(".player-audio");if(c&&c.dataset.src){const H=new Audio(c.dataset.src),$=t(".player-volume",c);$.addEventListener("change",(function(e){H.volume=e.currentTarget.value/100,localStorage.setItem("player_vol",H.volume)}),!1);var d=localStorage.getItem("player_vol");d&&(H.volume=d,$.value=100*d);var g=t(".player-toggle",c);t(".i-play",c),t(".i-pause",c);function m(){H.load(),l.classList.toggle("is-playing"),H.play(),g.innerHTML='<svg class="i i-pause" viewBox="0 0 24 24"><path d="M5 4h4v16H5Zm10 0h4v16h-4Z"></path></svg>'}function u(){l.classList.toggle("is-playing"),H.pause(),g.innerHTML='<svg class="i i-play" viewBox="0 0 24 24"><path d="m7 3 14 9-14 9z"></path></svg>'}"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("play",(function(){m()})),navigator.mediaSession.setActionHandler("pause",(function(){u()}))),g.addEventListener("click",(()=>{H.paused?m():u()}),!1)}const p="https://stream.radioani.me/api/nowplaying_static/japanisu.json",v=e("playerHistory");!function e(){fetch(p).then((e=>e.json())).then((s=>{let n=s.song_history,i=t(".song-now",l),a=t(".song-next",l),c=s.now_playing.remaining,d=t(".player-poster");d&&d.src&&(d.crossOrigin="Anonymous",d.src="https://images.weserv.nl/?url="+encodeURIComponent(s.now_playing.song.art),function(e,t){let s=new ColorThief;t.complete?e.setAttribute("style",`--accent: rgb(${s.getColor(t)})`):t.addEventListener("load",(function(){e.setAttribute("style",`--accent: rgb(${s.getColor(t)})`)}))}(document.body,d)),i&&r(i,s.now_playing.song),a&&r(a,s.playing_next.song);var g=x.classList.contains("is-active")?15:4;v&&(x.onclick=()=>{x.classList.remove("is-active"),S.classList.remove("has-history"),v.innerHTML=o(n,4)},L.onclick=()=>{x.classList.contains("is-active")?(x.classList.remove("is-active"),S.classList.remove("has-history"),v.innerHTML=o(n,4),L.innerText="Ver m√°s"):(x.classList.add("is-active"),S.classList.add("has-history"),v.innerHTML=o(n,15),L.innerText="Ver menos")},v.innerHTML=o(n,g)),"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:s.now_playing.song.title,artist:s.now_playing.song.artist,album:s.now_playing.song.album,artwork:[{src:s.now_playing.song.art,sizes:"96x96",type:"image/png"},{src:s.now_playing.song.art,sizes:"128x128",type:"image/png"},{src:s.now_playing.song.art,sizes:"192x192",type:"image/png"},{src:s.now_playing.song.art,sizes:"256x256",type:"image/png"}]})),document.querySelectorAll(".player-meta").forEach((e=>{var s=t(".song-title",e),n=s.offsetWidth,i=e.offsetWidth;e.setAttribute("style","--title-width:"+i+"px"),n>i?s.classList.add("song-very-long"):s.classList.remove("song-very-long")})),setTimeout(e,1e3*c)})).catch((e=>console.log(e)))}();const y=e("listeners");function f(e){return`\n    <div class="upcoming bg-dark shadow-xl" data-start="${e.start}" data-end="${e.end}" data-weekday="${e.day}" >\n      <img class="upcoming-image fit-image" src="${e.poster}" alt="${e.title}">\n      <div class="upcoming-data fs-7 relative py-.75 px-1.25">\n        <div class="upcoming-title fw-500 color-title nowrap">${e.title}</div>\n        <div class="upcoming-snippet fw-500 my-1">${e.snippet}</div>\n        <div class="upcoming-time">${e.start} - ${e.end}</div>\n      </div>\n    </div>\n  `}y&&function e(){fetch(p).then((e=>e.json())).then((t=>{let s=t.listeners.current;y.innerText=s,setTimeout(e,1e3*(y.dataset.update||5))})).catch((e=>console.log(e)))}();const h=e("program"),w=e("showWeeklySchedule"),L=e("showRecentlyPlayed"),x=e("closeHistory"),S=e("blog");function T(){let e=a(),t=h.querySelectorAll(".program-program"),n=s(e.time);t.forEach((t=>{if(t.dataset.week==e.week){t.querySelectorAll(".upcoming").forEach((e=>{let t=s(e.dataset.start),i=s(e.dataset.end);t<=n&&i>n?e.classList.add("is-online"):e.classList.remove("is-online")}))}}))}function b(){h.classList.add("program","grid","l:cols-7","cols-1","is-active"),h.querySelectorAll(".program-program").forEach((e=>{let t=e.dataset.week;var s,n,i;e.innerHTML=(s=currentSchedule,n=t,i="",s.forEach((e=>{e.day==n&&(i+=f(e))})),i)})),h.classList.remove("none")}h&&w.addEventListener("click",(()=>{w.classList.contains("is-active")?(w.classList.remove("is-active"),h.classList.add("none"),h.classList.remove("program","grid","l:cols-7","cols-1","is-active"),h.querySelectorAll(".program-program").forEach((e=>{e.innerHTML=""})),clearInterval(T)):(w.classList.add("is-active"),b(),T(),setInterval(T,1e4))}),!1);const k=e("renderUpcoming");function A(){let e=a();k.querySelectorAll(".upcoming").forEach((t=>{let n=(s(t.dataset.start)-s(e.time))/16+48,i=(s(t.dataset.start)-(s(e.time)-86400))/16+48;t.setAttribute("style",`transform: translateX(${t.dataset.weekday==e.week?n:i}px)`),t.classList.add("is-loaded")}))}k&&(A(),setInterval(A,2e4)),function e(){let t=a(),n=s("24:00")-s(t.time);k&&(k.innerHTML=function(e){let t=a();var s="";let n=(i=t.week,o="","lunes"==i?o="martes":"martes"==i?o="mi√©rcoles":"mi√©rcoles"==i?o="jueves":"jueves"==i?o="viernes":"viernes"==i?o="s√°bado":"s√°bado"==i?o="domingo":"domingo"==i&&(o="lunes"),o);var i,o;return e.forEach((e=>{e.day!=t.week&&e.day!=n||(s+=f(e))})),s}(currentSchedule)),A(),setTimeout(e,1e3*(0===n?10:n))}();const E=document.querySelector(".header-player");window.innerWidth>760&&function(){if(E){var e=E.offsetHeight;window.addEventListener("scroll",(function(){window.scrollY>E.offsetTop+e?(E.nextElementSibling.setAttribute("style","margin-top:"+e+"px"),E.classList.add("header-sticky","fixed","z-100","t-0","x-0")):(E.classList.remove("header-sticky","fixed","z-100","t-0","x-0"),E.nextElementSibling.removeAttribute("style"))}))}}();